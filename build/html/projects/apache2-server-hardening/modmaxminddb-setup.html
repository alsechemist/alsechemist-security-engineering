

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setting Up Mod Maxmind DB &mdash; Security Engineering 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\css\lightbox.min.css?v=6e7d0de0" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\pointer.css?v=c97663ff" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom-styling/side-panel.css?v=1d19113b" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=7310f75f"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\js\lightbox-plus-jquery.min.js?v=f0ca4bb6"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js?v=12818e64"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Introduction - Nginx Server Hardening" href="../nginx-server-hardening/introduction.html" />
    <link rel="prev" title="Setting Up Mod Evasive" href="modevasive-setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Security Engineering
              <img src="../../_static/alsechemist-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/about-alsechemist.html">About Alsechemist</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../research/research.html">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/knowledge-base.html">Knowledge Base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../wazuh-tracecat-integration/introduction.html">Wazuh &amp; Tracecat Integration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Apache2 Server Hardening</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scope-of-engagement.html">Scope of Engagement</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic-setup-and-prerquisites.html">Generic Setup &amp; Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="modevasive-setup.html">Setting Up Mod Evasive</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Setting Up Mod Maxmind DB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites-reference">Prerequisites - (Reference)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installing-libmaxminddb">Installing libmaxminddb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#installing-mod-maxminddb">Installing mod_maxminddb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-the-maxmind-database">Installing the Maxmind Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-mod-maxminddb-module">Configuring the mod_maxminddb Module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enabling-mod-maxminddb-module">Enabling mod_maxminddb Module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#testing-the-mod-maxminddb-module">Testing the mod_maxminddb Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../nginx-server-hardening/introduction.html">Nginx Server Hardening</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/modsecurity-log-detection-wazuh/introduction.html">Detecting ModSecurity Logs in Wazuh Using Custom Decoders and Rules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledge Base</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/configuration-active-response-macos/configuration-active-response-macos.html">Configuring Wazuh Active Response for macOS Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/understand-manipulate-json-decoders-wazuh/understand-manipulate-json-decoders-wazuh.html">Understanding &amp; Manipulating Wazuh JSON Decoders</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Security Engineering</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="introduction.html">Introduction - Apache2 Server Hardening</a></li>
      <li class="breadcrumb-item active">Setting Up Mod Maxmind DB</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setting-up-mod-maxmind-db">
<h1>Setting Up Mod Maxmind DB<a class="headerlink" href="#setting-up-mod-maxmind-db" title="Link to this heading"></a></h1>
<p><strong>mod_maxminddb</strong> is an Apache module that allows the server to query MaxMind DB files to identify information about a website visitor based on their IP address.
It is the modern successor to the now-deprecated <a class="reference external" href="https://github.com/maxmind/geoip-api-mod_geoip2" rel="noreferrer" target="_blank">mod_geoip <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>. It basically allows Apache to determine a client’s geographic and network-related information—such as country,
city, ASN, or organization—based on the client IP address.</p>
<p>Now let’s work on installing the <code class="docutils literal notranslate"><span class="pre">mod_maxminddb</span></code> using the latest MaxMind Database. The <code class="docutils literal notranslate"><span class="pre">mod_maxminddb</span></code> is also known as <code class="docutils literal notranslate"><span class="pre">mod_geoip</span> <span class="pre">v2</span></code>.</p>
<section id="prerequisites-reference">
<h2>Prerequisites - (<a class="reference external" href="https://github.com/maxmind/mod_maxminddb#requirements" rel="noreferrer" target="_blank">Reference <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>)<a class="headerlink" href="#prerequisites-reference" title="Link to this heading"></a></h2>
<p>This module requires Apache 2.2 or 2.4 to be installed, including any corresponding “dev” package, such as <code class="docutils literal notranslate"><span class="pre">apache2-dev</span></code> on Ubuntu.
You should have <code class="docutils literal notranslate"><span class="pre">apxs</span></code> or <code class="docutils literal notranslate"><span class="pre">apxs2</span></code> in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.</p>
<p>You also must install the <a class="reference external" href="https://github.com/maxmind/libmaxminddb" rel="noreferrer" target="_blank">libmaxminddb <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> C library.</p>
<section id="installing-libmaxminddb">
<h3>Installing libmaxminddb<a class="headerlink" href="#installing-libmaxminddb" title="Link to this heading"></a></h3>
<p>Download and extract their latest official release from <a class="reference external" href="https://github.com/maxmind/libmaxminddb" rel="noreferrer" target="_blank">libmaxminddb GitHub <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> Page.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/maxmind/libmaxminddb/releases/download/&lt;version&gt;/libmaxminddb-&lt;version&gt;.tar.gz
tar<span class="w"> </span>-xzvf<span class="w"> </span>libmaxminddb-&lt;version&gt;.tar.gz
<span class="nb">cd</span><span class="w"> </span>libmaxminddb-&lt;version&gt;
</pre></div>
</div>
<p>Replace the <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> with latest version following their GitHub <a class="reference external" href="https://github.com/maxmind/libmaxminddb/releases" rel="noreferrer" target="_blank">libmaxminddb Release <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> page.</p>
<p>Next, to install it, run the following commands,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure
make
make<span class="w"> </span>check
make<span class="w"> </span>install
ldconfig
</pre></div>
</div>
<p>After installing, the <strong>libmaxminddb</strong> library will be available at <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code></p>
<p>If everything goes well, you will receive this output in the prompt. Refer to the image below for a high level view,</p>
<a class=""
               data-lightbox="group-481d5df9-1bdf-4110-8ab1-d10f97adca67"
               href="../../_images/settingup-modmaxminddb-11.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-11.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="libmaxminddb Installation Message - Successful"/>
                </a><div style="height:25px;"></div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can skip the <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">check</span></code> step but it’s always good to know that tests are passing on your platform.</p>
<p>The configure script takes the standard options to set where files are installed such as <code class="docutils literal notranslate"><span class="pre">--prefix</span></code>, etc. See <code class="docutils literal notranslate"><span class="pre">./configure</span> <span class="pre">--help</span></code> for details.</p>
<p>If after installing, you receive an error that <strong>libmaxminddb.so.0</strong> is missing you may need to add the lib directory in your prefix to your library path.
On most Linux distributions when using the default prefix (<code class="docutils literal notranslate"><span class="pre">/usr/local</span></code>), you can do this by running the following commands,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;echo /usr/local/lib  &gt;&gt; /etc/ld.so.conf.d/local.conf&quot;</span>
ldconfig
</pre></div>
</div>
<p>Otherwise, you can skip this step.</p>
</div>
</section>
</section>
<section id="installing-mod-maxminddb">
<h2>Installing mod_maxminddb<a class="headerlink" href="#installing-mod-maxminddb" title="Link to this heading"></a></h2>
<p>Install the required apache2 dev package,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt<span class="w"> </span>install<span class="w"> </span>apache2-dev
</pre></div>
</div>
<p>Next, download and extract the mod_maxminddb latest official release from their <a class="reference external" href="https://github.com/maxmind/mod_maxminddb" rel="noreferrer" target="_blank">mod_maxminddb GitHub <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> page.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/maxmind/mod_maxminddb/releases/download/&lt;version&gt;/mod_maxminddb-&lt;version&gt;.tar.gz
tar<span class="w"> </span>-xzvf<span class="w"> </span>mod_maxminddb-&lt;version&gt;.tar.gz
<span class="nb">cd</span><span class="w"> </span>mod_maxminddb-&lt;version&gt;
</pre></div>
</div>
<p>Replace the <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> with latest version following their GitHub <a class="reference external" href="https://github.com/maxmind/mod_maxminddb/releases" rel="noreferrer" target="_blank">mod_maxminddb Release <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> page.</p>
<p>To install the module, run the following commands,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure
make<span class="w"> </span>install
</pre></div>
</div>
<p>If everything goes well, you will this dialogue <code class="docutils literal notranslate"><span class="pre">preparing</span> <span class="pre">module</span> <span class="pre">`maxminddb'</span> <span class="pre">in</span> <span class="pre">/etc/apache2/mods-available/maxminddb.load</span></code> in the prompt</p>
<p>Refer to the image below for a high level view,</p>
<a class=""
               data-lightbox="group-12ac8501-040d-45f8-a8c9-e361aa6db39e"
               href="../../_images/settingup-modmaxminddb-21.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-21.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="mod_maxminddb Installation Message - Successful"/>
                </a><div style="height:25px;"></div><p>So far the installation of <strong>mod_maxminddb</strong> is complete.</p>
</section>
<section id="installing-the-maxmind-database">
<h2>Installing the Maxmind Database<a class="headerlink" href="#installing-the-maxmind-database" title="Link to this heading"></a></h2>
<p>Now let’s pay attention to this step carefully. Coming this far you might get a little bit confused whether we installed the module or the database.
We actually installed the module only; the database doesn’t come with the installation procedure.</p>
<p>So, to install the Maxmind Database from MaxMind we need to create an account in their portal.
GeoIP basically has two versions of databases, one is free and the other is paid.
Well, the paid one comes with comes with some distinct features of course, but the free version gets most of the jobs done any ways.
I would say both of them are highly reliable.</p>
<p>Here, we are going to go with the free version.</p>
<p>Go and <a class="reference external" href="https://www.maxmind.com/en/geolite2/signup" rel="noreferrer" target="_blank">Sign Up <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> for an account to get access to the GeoLite Database from the link.
Once you are done creating the account, head over to Manage License Keys and generate a key and keep it safe and saved for future use,
as we are going to need it for the database installation.</p>
<a class=""
               data-lightbox="group-36d2afff-2151-4299-b9e0-31dfe9ef1b5f"
               href="../../_images/settingup-modmaxminddb-31.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-31.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Path to Manage License Keys"/>
                </a><div style="height:25px;"></div><p>After generating the key, it will also show your user along. Remember to keep is safe and secured as well, case it will also be need for the database installation.</p>
<a class=""
               data-lightbox="group-a438c479-42ee-4358-9df2-7dbbf96e62b8"
               href="../../_images/settingup-modmaxminddb-41.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-41.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Creating License Keys"/>
                </a><div style="height:25px;"></div><p>You can also checkout the procedure of how you can keep your databases up to date as geoip2 receive weekly updates.
I am not demonstrating that here as, it is already well documented in their website and you can easily access the page via clicking that link from your account.</p>
<p>Now head over to the <strong>Download Files</strong></p>
<a class=""
               data-lightbox="group-c768983a-8445-464c-b7a6-d1dfc370b024"
               href="../../_images/settingup-modmaxminddb-51.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-51.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Path to Download Files"/>
                </a><div style="height:25px;"></div><p>And then get the Permalinks of GeoLite Database.</p>
<a class=""
               data-lightbox="group-a20f3922-dc70-4499-becc-e19083952452"
               href="../../_images/settingup-modmaxminddb-61.png"
               title=""
               data-title=""
               
               ><img src="../../_images/settingup-modmaxminddb-61.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Path to Download Files"/>
                </a><div style="height:25px;"></div><p>Finally run this command in your Machine to download the GeoLite2 Database using your user id and key that we have obtained earlier.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>--content-disposition<span class="w"> </span>--user<span class="o">=</span>YOUR_ACCOUNT_ID<span class="w"> </span>--password<span class="o">=</span>YOUR_LICENSE_KEY<span class="w"> </span><span class="s1">&#39;&lt;permalink_URL&gt;&#39;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">--user</span></code>, <code class="docutils literal notranslate"><span class="pre">--password</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">&lt;permalink_URL&gt;</span></code> with your actual credentials. Once the downloading has finished <strong>Extract</strong> <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code> file.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more detailed information regarding downloading and automatically updating the databases,
refer to their official documention about <a class="reference external" href="https://dev.maxmind.com/geoip/updating-databases/#using-geoip-update" rel="noreferrer" target="_blank">Using GeoIP Update <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.</p>
</div>
<p>So far installation of the database is complete.</p>
</section>
<section id="configuring-the-mod-maxminddb-module">
<h2>Configuring the mod_maxminddb Module<a class="headerlink" href="#configuring-the-mod-maxminddb-module" title="Link to this heading"></a></h2>
<p>Now, we need to configure the mod_maxminddb module. Head over to the <code class="docutils literal notranslate"><span class="pre">/etc/apache2/mods-available</span></code> directory and create a file named <code class="docutils literal notranslate"><span class="pre">maxminddb.conf</span></code>,
which will be the actual configuration file of the <strong>MaxMindDB</strong> module.</p>
<p>Apply the directives in the configuration file as given below,</p>
<div class="highlight-apache notranslate"><div class="highlight"><pre><span></span><span class="nb">MaxMindDBEnable</span><span class="w"> </span><span class="k">On</span>
<span class="nb">MaxMindDBFile</span><span class="w"> </span>COUNTRY_DB<span class="w"> </span>&lt;/path/to/maxmind/database/.mmdb/file&gt;
<span class="nb">MaxMindDBEnv</span><span class="w"> </span>COUNTRY_CODE<span class="w"> </span>COUNTRY_DB/country/iso_code
<span class="nb">MaxMindDBNetworkEnv</span><span class="w"> </span>COUNTRY_DB<span class="w"> </span>COUNTRY_NETWORK
<span class="nb">MaxMindDBSetNotes</span><span class="w"> </span><span class="k">On</span>

<span class="nt">&lt;Directory</span><span class="w"> </span><span class="s">/var/www</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nb">SetEnvIf</span><span class="w"> </span>COUNTRY_CODE<span class="w"> </span>^(US|SG|NL|RU|DE|FR|BD)<span class="w"> </span>BlockCountry
<span class="w">    </span><span class="nt">&lt;RequireAll&gt;</span>
<span class="w">        </span><span class="nb">Require</span><span class="w"> </span>env<span class="w"> </span>COUNTRY_CODE
<span class="w">        </span><span class="nb">Require</span><span class="w"> </span>not<span class="w"> </span>env<span class="w"> </span>BlockCountry
<span class="w">    </span><span class="nt">&lt;/RequireAll&gt;</span>
<span class="nt">&lt;/Directory&gt;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;/path/to/maxmind/database/.mmdb/file&gt;</span></code> with the actual path to the country database file. You can also specify the countries to be blocked as you like in
the <code class="docutils literal notranslate"><span class="pre">^()</span></code> block as you like.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this case scenario, only the database related to country aka <code class="docutils literal notranslate"><span class="pre">COUNTRY_DB</span></code> was used,
where countries with their Alpha-2 Code are used to block the specified country. This is more like a black-listing approach.
Database related to cities can also be used, refer to their <a class="reference external" href="https://github.com/maxmind/mod_maxminddb?tab=readme-ov-file#maxminddbfile" rel="noreferrer" target="_blank">MaxMindDBFile Directive <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>
and keeping following along to know how to use the <code class="docutils literal notranslate"><span class="pre">CITY_DB</span></code>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Cases may vary depending on situations and scenarios, for which it is highly recommended to explore various use cases that would serve the cause.
Follow along the <a class="reference external" href="https://github.com/maxmind/mod_maxminddb?tab=readme-ov-file#usage" rel="noreferrer" target="_blank">Usage Section <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> to have a clear understanding of
its directives and use cases.</p>
</div>
<section id="enabling-mod-maxminddb-module">
<h3>Enabling mod_maxminddb Module<a class="headerlink" href="#enabling-mod-maxminddb-module" title="Link to this heading"></a></h3>
<p>First check if the maxminddb module is enabled,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apache2ctl<span class="w"> </span>-M<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>maxminddb_module
</pre></div>
</div>
<p>If it’s enabled, it will show an output like <strong>maxminddb_module (shared)</strong>.</p>
<p>Otherwise, if you don’t find anything similar, run the command below to enable it,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a2enmod<span class="w"> </span>maxminddb
</pre></div>
</div>
<p>Then finally restart the apache2 server to put it into action.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl<span class="w"> </span>restart<span class="w"> </span>apache2
</pre></div>
</div>
<p>You shouldn’t receive any error is everything is alright.</p>
</section>
</section>
<section id="testing-the-mod-maxminddb-module">
<h2>Testing the mod_maxminddb Module<a class="headerlink" href="#testing-the-mod-maxminddb-module" title="Link to this heading"></a></h2>
<p>In order to test the module, we will be requiring a <strong>VPN</strong> from the countries specified to be blocked. Set up a VPN connection and trying access the http server via
your browser using the apache2 server URL</p>
<p>It should return a <code class="docutils literal notranslate"><span class="pre">403</span> <span class="pre">Forbidden</span></code> status in response, blocking your access.</p>
<p>Refer to the image below for a high level view,</p>
<a class=""
               data-lightbox="group-f398e363-dfbd-4d1e-8ae5-a4f394bce7de"
               href="../../_images/status-403-forbidden1.png"
               title=""
               data-title=""
               
               ><img src="../../_images/status-403-forbidden1.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Returing 403 Forbidden status"/>
                </a><div style="height:25px;"></div><p>Finally, from here, this concludes the setting up of Mod Maxmind DB</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modevasive-setup.html" class="btn btn-neutral float-left" title="Setting Up Mod Evasive" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../nginx-server-hardening/introduction.html" class="btn btn-neutral float-right" title="Introduction - Nginx Server Hardening" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Alsechemist.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>