

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Conditional Executions of The Active Response Components &mdash; Security Engineering 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\css\lightbox.min.css?v=6e7d0de0" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\pointer.css?v=c97663ff" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom-styling/side-panel.css?v=1d19113b" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=9760a2b4"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\js\lightbox-plus-jquery.min.js?v=f0ca4bb6"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js?v=12818e64"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Automated Runs" href="automated-runs.html" />
    <link rel="prev" title="Efficient Workflow Execution" href="efficient-workflow-execution.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Security Engineering
              <img src="../../_static/alsechemist-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/about-alsechemist.html">About Alsechemist</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../research/research.html">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/knowledge-base.html">Knowledge Base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Wazuh &amp; Tracecat Integration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what-is-wazuh.html">What is Wazuh?</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-is-tracecat.html">What is Tracecat?</a></li>
<li class="toctree-l2"><a class="reference internal" href="the-power-of-integration.html">The Power of Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-we-will-learn.html">What We’ll Learn?</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope-of-engagement.html">Scope of Engagement</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="configuration-of-servers.html">Configurations of Servers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="wazuh-server.html">Wazuh Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview-tracecat-server.html">Overview: Tracecat Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="prerequisite.html">Prerequisite</a></li>
<li class="toctree-l3"><a class="reference internal" href="tracecat-server-components.html">Tracecat Server Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="efficient-workflow-execution.html">Efficient Workflow Execution</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Conditional Executions of The Active Response Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#for-linux-agents">For Linux Agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#for-windows-agents">For Windows Agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#for-macos-agents">For macOS Agents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="automated-runs.html">Automated Runs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="proof-of-concept.html">Proof of Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apache2-server-hardening/introduction.html">Apache2 Server Hardening</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nginx-server-hardening/introduction.html">Nginx Server Hardening</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/modsecurity-log-detection-wazuh/introduction.html">Detecting ModSecurity Logs in Wazuh Using Custom Decoders and Rules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledge Base</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/configuration-active-response-macos/configuration-active-response-macos.html">Configuring Wazuh Active Response for macOS Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/manipulation-json-decoders-wazuh/manipulation-json-decoders-wazuh.html">Manipulating Wazuh JSON Decoders</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Security Engineering</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="introduction.html">Introduction - Wazuh &amp; Tracecat integration</a></li>
          <li class="breadcrumb-item"><a href="configuration-of-servers.html">Configurations of Servers</a></li>
      <li class="breadcrumb-item active">Conditional Executions of The Active Response Components</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="conditional-executions-of-the-active-response-components">
<h1>Conditional Executions of The Active Response Components<a class="headerlink" href="#conditional-executions-of-the-active-response-components" title="Link to this heading"></a></h1>
<p>Now we will look, how we can make the active response components to execute whenever there is an actual SSH Brute Force Attack. So, let’s get started.</p>
<p>Switch to the <strong>Control Flow</strong> tab beside <strong>Inputs,</strong> you will notice that there is a <strong>Run if</strong> field asking for some <strong>JSON Path Expressions</strong> to be specified.
It will execute the components only if the specified parameter is found.</p>
<section id="for-linux-agents">
<h2>For Linux Agents<a class="headerlink" href="#for-linux-agents" title="Link to this heading"></a></h2>
<p>As for the linux endpoints, Wazuh has already specified rule-ids for SSH Brute force attacks along with the severity level.
A unique parameter can be the <code class="docutils literal notranslate"><span class="pre">rule.id</span></code> of the attack that is generated on the Wazuh Indexer Server. The unique rule.id that is generated for
SSH Brute Force Attacks is <code class="docutils literal notranslate"><span class="pre">5763</span></code></p>
<p>Go to the <strong>Wazuh Indexer Logs</strong> component and check the results tab, you will find the rule.id, something like as the image shown below:</p>
<a class=""
               data-lightbox="group-40ce1c5d-43d8-4fbd-a868-cd512f31f91f"
               href="../../_images/tracecat-conditional-workflow-configuration-11.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-11.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat, Copying JSON Path Guideline for Linux Agents"/>
                </a><div style="height:25px;"></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.rule.id == &quot;5763&quot; }}</span>
</pre></div>
</div>
<p>Copy the JSON path and paste it on the <strong>Run if</strong> section of the <strong>Active Response for Linux</strong> component or
we can say the <code class="docutils literal notranslate"><span class="pre">core.http_request</span></code> component that we have configured for the linux agents.
An image has been attached below for showcasing it.</p>
<a class=""
               data-lightbox="group-de1c5505-26bb-4f94-a372-627f53ef639f"
               href="../../_images/tracecat-conditional-workflow-configuration-21.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-21.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Conditional Workflow Execution for Linux Agents"/>
                </a><div style="height:25px;"></div><p>And that’s it, we have enabled conditional execution for the AR of linux Endpoints.</p>
</section>
<section id="for-windows-agents">
<h2>For Windows Agents<a class="headerlink" href="#for-windows-agents" title="Link to this heading"></a></h2>
<p>Similarly, for the windows endpoints, Wazuh has already specified rule-ids for
both RDP and SSH Brute force attacks along with the severity level. Since we have already looked at SSH Brute force attack,
we will focus on RDP Brute force attack here.</p>
<p>A unique parameter can be the <code class="docutils literal notranslate"><span class="pre">rule.id</span></code> of the attack that is generated on the Wazuh Indexer Server.
The unique <code class="docutils literal notranslate"><span class="pre">rule.id</span></code> that is generated for RDP Brute Force Attacks is <code class="docutils literal notranslate"><span class="pre">60204</span></code></p>
<p>Go to the <strong>Wazuh Indexer Logs</strong> component and check the results tab, you will find the <code class="docutils literal notranslate"><span class="pre">rule.id</span></code>, something like as the image shown below:</p>
<a class=""
               data-lightbox="group-0b9ccf13-6573-47cd-ba3f-3a681c885657"
               href="../../_images/tracecat-conditional-workflow-configuration-31.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-31.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat, Copying JSON Path Guideline for Windows Agents"/>
                </a><div style="height:25px;"></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.rule.id == &quot;60204&quot;}}</span>
</pre></div>
</div>
<p>Copy the JSON path and paste it on the <strong>Run if</strong> section of the <strong>Active Response for Windows</strong> component or
we can say the <code class="docutils literal notranslate"><span class="pre">core.http_request</span></code> component that we have configured for the windows agents.
An image has been attached below for showcasing it.</p>
<a class=""
               data-lightbox="group-49043cca-930e-4d70-866a-62d6d143b79e"
               href="../../_images/tracecat-conditional-workflow-configuration-41.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-41.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Conditional Workflow Execution for Windows Agents"/>
                </a><div style="height:25px;"></div><p>And that’s it, we have enabled conditional execution for AR of windows endpoints.</p>
</section>
<section id="for-macos-agents">
<h2>For macOS Agents<a class="headerlink" href="#for-macos-agents" title="Link to this heading"></a></h2>
<p>Finally, for the macOS endpoints, Wazuh has already specified rule-ids for SSH Brute force attacks along with the severity level.
A unique parameter can be the <code class="docutils literal notranslate"><span class="pre">rule.id</span></code> of the attack that is generated on the Wazuh Indexer Server.
The unique <code class="docutils literal notranslate"><span class="pre">rule.id</span></code> that is generated for SSH Brute Force Attacks is <code class="docutils literal notranslate"><span class="pre">5712</span></code></p>
<p>Go to the <strong>Wazuh Indexer Logs</strong> component and check the results tab, you will find the <code class="docutils literal notranslate"><span class="pre">rule.id</span></code>, something like as the image shown below:</p>
<a class=""
               data-lightbox="group-58044bc5-3306-47e1-8ef5-6d2c41ae72ba"
               href="../../_images/tracecat-conditional-workflow-configuration-51.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-51.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat, Copying JSON Path Guideline for macOS Agents"/>
                </a><div style="height:25px;"></div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.rule.id == &quot;5712&quot; }}</span>
</pre></div>
</div>
<p>Copy the JSON path and paste it on the <strong>Run if</strong> section of the <strong>Active Response for macOS</strong> component or
we can say the <code class="docutils literal notranslate"><span class="pre">core.http_request</span></code> component that we have configured for the windows agents.
An image has been attached below for showcasing it.</p>
<a class=""
               data-lightbox="group-196168a1-c726-4ba1-a648-75b5a15bc518"
               href="../../_images/tracecat-conditional-workflow-configuration-61.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-conditional-workflow-configuration-61.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Conditional Workflow Execution for macOS Agents"/>
                </a><div style="height:25px;"></div><p>And that’s it, we have enabled conditional execution for AR of macOS endpoints.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The JSON paths in the above code blocks are just like variables named after the naming convention of the Title given to each component.
For example, <strong>ACTIONS.</strong> <code class="docutils literal notranslate"><span class="pre">wazuh_indexer_logs</span></code> <strong>.result.data.hits.hits[0]._source.rule.id</strong>, the quoted red colored area is
exactly as the Title set the to the Wazuh_Indexer_Logs core.http_response component.</p>
<p>Blindly copying and pasting the above code blocks might result in workflow execution <code class="docutils literal notranslate"><span class="pre">errors</span></code>.
Viewers are advised to work with the comfort oftheir local environmental setup.</p>
<p>The above code blocks are given only for representation purposes. The JSON path might be different from what has been showcased here.
That is why images have been given to follow it as a reference.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="efficient-workflow-execution.html" class="btn btn-neutral float-left" title="Efficient Workflow Execution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="automated-runs.html" class="btn btn-neutral float-right" title="Automated Runs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Alsechemist.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>