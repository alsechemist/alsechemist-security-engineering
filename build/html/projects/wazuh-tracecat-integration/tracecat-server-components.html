

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tracecat Server Components &mdash; Security Engineering 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\css\lightbox.min.css?v=6e7d0de0" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\pointer.css?v=c97663ff" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom-styling/side-panel.css?v=1d19113b" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=7310f75f"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2\dist\js\lightbox-plus-jquery.min.js?v=f0ca4bb6"></script>
      <script src="../../_static/sphinxcontrib-images\LightBox2\lightbox2-customize\jquery-noconflict.js?v=12818e64"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Efficient Workflow Execution" href="efficient-workflow-execution.html" />
    <link rel="prev" title="Prerequisite" href="prerequisite.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Security Engineering
              <img src="../../_static/alsechemist-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../main/about-alsechemist.html">About Alsechemist</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../research/research.html">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/knowledge-base.html">Knowledge Base</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Projects</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="introduction.html">Wazuh &amp; Tracecat Integration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="what-is-wazuh.html">What is Wazuh?</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-is-tracecat.html">What is Tracecat?</a></li>
<li class="toctree-l2"><a class="reference internal" href="the-power-of-integration.html">The Power of Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="what-we-will-learn.html">What We’ll Learn?</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope-of-engagement.html">Scope of Engagement</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="configuration-of-servers.html">Configurations of Servers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="wazuh-server.html">Wazuh Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview-tracecat-server.html">Overview: Tracecat Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="prerequisite.html">Prerequisite</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Tracecat Server Components</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tools-wazuh-get-access-token-wazuh-api">tools.wazuh.get_access_token (Wazuh API)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-http-request-wazuh-indexer-logs">core.http_request (Wazuh_Indexer_Logs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-http-request-wazuh-server-logs">core.http_request (Wazuh_Server_Logs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-http-request-active-response-for-linux">core.http_request (Active Response for Linux)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-http-request-active-response-for-windows">core.http_request (Active Response for Windows)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#core-http-request-active-response-for-macos">core.http_request (Active Response for macOS)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="efficient-workflow-execution.html">Efficient Workflow Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="conditional-executions-of-the-active-response-components.html">Conditional Executions of The Active Response Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="automated-runs.html">Automated Runs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="proof-of-concept.html">Proof of Concept</a></li>
<li class="toctree-l2"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apache2-server-hardening/introduction.html">Apache2 Server Hardening</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nginx-server-hardening/introduction.html">Nginx Server Hardening</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Research</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/modsecurity-log-detection-wazuh/introduction.html">Detecting ModSecurity Logs in Wazuh Using Custom Decoders and Rules</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Knowledge Base</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/configuration-active-response-macos/configuration-active-response-macos.html">Configuring Wazuh Active Response for macOS Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/understand-manipulate-json-decoders-wazuh/understand-manipulate-json-decoders-wazuh.html">Understanding &amp; Manipulating Wazuh JSON Decoders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../knowledge-base/iptables-comprehensive-firewall-management/introduction.html">IPTables - Comprehensive Firewall Management</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Security Engineering</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="introduction.html">Introduction - Wazuh &amp; Tracecat integration</a></li>
          <li class="breadcrumb-item"><a href="configuration-of-servers.html">Configurations of Servers</a></li>
      <li class="breadcrumb-item active">Tracecat Server Components</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tracecat-server-components">
<h1>Tracecat Server Components<a class="headerlink" href="#tracecat-server-components" title="Link to this heading"></a></h1>
<p>Now let’s begin configuring the previously mentioned Tracecat components. Rather deep diving into it,
I will try to simply explain what we are trying to achieve through these components. By selecting each component you will notice an
input tab asking you to fill up the given required fields. So instead of explaining each field, I will directly focus on its <cite>YAML</cite> configuration to
explain what we are trying to achieve by setting the parameters.</p>
<section id="tools-wazuh-get-access-token-wazuh-api">
<h2>tools.wazuh.get_access_token (Wazuh API)<a class="headerlink" href="#tools-wazuh-get-access-token-wazuh-api" title="Link to this heading"></a></h2>
<p>Go to the <code class="docutils literal notranslate"><span class="pre">YAML</span></code> tab. Copy and paste the below code block:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Server_IP]:55000</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p>The below code just sends a https request to the Wazuh Server API. At backend, the component does its job to fetch the JWT Token.</p>
<a class=""
               data-lightbox="group-6bf984e5-2c4c-4023-80ed-73143b1a5335"
               href="../../_images/tracecat-server-workflow-contifiguration-11.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-11.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh JWT Token Configuration"/>
                </a><div style="height:25px;"></div></section>
<section id="core-http-request-wazuh-indexer-logs">
<h2>core.http_request (Wazuh_Indexer_Logs)<a class="headerlink" href="#core-http-request-wazuh-indexer-logs" title="Link to this heading"></a></h2>
<p>Go to the YAML tab. Copy and paste the below code block:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Sever_IP]:9200/wazuh-alerts-4.x-*/_search</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer ${{ ACTIONS.wazuh_api.result }}</span>
<span class="w">    </span><span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">auth</span><span class="p">:</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ SECRETS.wazuh_indexer.WAZUH_INDEXER_USERNAME }}</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ SECRETS.wazuh_indexer.WAZUH_INDEXER_PASSWORD }}</span>
<span class="nt">payload</span><span class="p">:</span>
<span class="w">    </span><span class="nt">query</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bool</span><span class="p">:</span>
<span class="w">            </span><span class="nt">must</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">terms</span><span class="p">:</span>
<span class="w">                </span><span class="nt">rule.id</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5763&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;60204&quot;</span>
<span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;5712&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">range</span><span class="p">:</span>
<span class="w">                </span><span class="s">&quot;@timestamp&quot;</span><span class="p p-Indicator">:</span>
<span class="w">                    </span><span class="nt">gte</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">now-1m</span>
<span class="w">                    </span><span class="nt">lte</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">now</span>
<span class="w">    </span><span class="nt">sort</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;@timestamp&quot;</span><span class="p p-Indicator">:</span>
<span class="w">            </span><span class="nt">order</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">desc</span>
<span class="w">    </span><span class="nt">size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
</pre></div>
</div>
<p>The above code contacts the Wazuh Indexer API Server with the required Wazuh Indexer credentials that we have set earlier and
sends a search request to provide data or logs based on <code class="docutils literal notranslate"><span class="pre">rule.id</span> <span class="pre">5763,</span> <span class="pre">60204,</span> <span class="pre">5712</span></code> from the last 1 minute.
And, It will so up to 10 unique sets of data if available. You can set the time, and size according to your convenience.</p>
<a class=""
               data-lightbox="group-abc77b43-7563-431e-83c6-07e9e8bfc689"
               href="../../_images/tracecat-server-workflow-contifiguration-21.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-21.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh Indexer Configuration"/>
                </a><div style="height:25px;"></div></section>
<section id="core-http-request-wazuh-server-logs">
<h2>core.http_request (Wazuh_Server_Logs)<a class="headerlink" href="#core-http-request-wazuh-server-logs" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>This is an <strong>optional</strong> component in this workflow kept,</dt><dd><p>to demonstrate the possibilities you can leverage by accessing the Wazuh Server API.
You can visit Wazuh’s <a class="reference external" href="https://documentation.wazuh.com/current/user-manual/api/reference.html" rel="noreferrer" target="_blank">Server API Reference <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>
to know how you can utilize it to the fullest. Go to the <code class="docutils literal notranslate"><span class="pre">YAML</span></code> tab. Copy and paste the below code block:</p>
</dd>
</dl>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Sever_IP]:55000/agents</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer ${{ ACTIONS.wazuh_api.result }}</span>
<span class="w">    </span><span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
</pre></div>
</div>
<p>The above code contacts the <strong>Wazuh Server API</strong> with collected JWT Token for fetching the list of available agent data on your wazuh server.</p>
<a class=""
               data-lightbox="group-6abfa19d-f823-4676-bc68-ed9a4b0f1115"
               href="../../_images/tracecat-server-workflow-contifiguration-31.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-31.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh Server API Configuration"/>
                </a><div style="height:25px;"></div></section>
<section id="core-http-request-active-response-for-linux">
<h2>core.http_request (Active Response for Linux)<a class="headerlink" href="#core-http-request-active-response-for-linux" title="Link to this heading"></a></h2>
<p>Go to the YAML tab. Copy and paste the below code block:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Sever_IP]:55000/active-response</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PUT</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer ${{ ACTIONS.wazuh_api.result }}</span>
<span class="w">    </span><span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">payload</span><span class="p">:</span>
<span class="w">    </span><span class="nt">arguments</span><span class="p">:</span><span class="w"> </span><span class="c1"># # must be an array argument</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">add</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;!firewall-drop&quot;</span>
<span class="w">    </span><span class="nt">alert</span><span class="p">:</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="w">            </span><span class="nt">srcip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.data.srcip }}</span>
<span class="w">        </span><span class="nt">rule</span><span class="p">:</span>
<span class="w">            </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5763</span>
<span class="w">            </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">params</span><span class="p">:</span>
<span class="w">    </span><span class="nt">agents_list</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;001&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;002&quot;</span>
</pre></div>
</div>
<p>The above code contacts the <strong>Wazuh Server API</strong> with collected JWT Token to initiate its active response module to run the <code class="docutils literal notranslate"><span class="pre">firewall-drop</span></code> script on
linux agents. The script has additional arguments such as <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">add,</span> <span class="pre">-</span> <span class="pre">delete,</span> <span class="pre">-</span> <span class="pre">[time]</span></code> for blocking the malicious IP for a specific time and more,
based on the <code class="docutils literal notranslate"><span class="pre">rule.id</span> <span class="pre">5763</span></code> and its level of severity. You can also set the list of Linux agents you want the script to run on dynamically or
statically based on the <code class="docutils literal notranslate"><span class="pre">agent.id</span></code> found on your wazuh server.</p>
<a class=""
               data-lightbox="group-80b44417-ebf3-47d8-a000-61c42eb255f6"
               href="../../_images/tracecat-server-workflow-contifiguration-41.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-41.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh Active Response Configuration for Linux Agents"/>
                </a><div style="height:25px;"></div></section>
<section id="core-http-request-active-response-for-windows">
<h2>core.http_request (Active Response for Windows)<a class="headerlink" href="#core-http-request-active-response-for-windows" title="Link to this heading"></a></h2>
<p>Go to the YAML tab. Copy and paste the below code block:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Sever_IP]:55000/active-response</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PUT</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer ${{ ACTIONS.wazuh_api.result }}</span>
<span class="w">    </span><span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">payload</span><span class="p">:</span>
<span class="w">    </span><span class="nt">arguments</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">add</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;!netsh&quot;</span>
<span class="w">    </span><span class="nt">alert</span><span class="p">:</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="w">            </span><span class="nt">srcip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.data.win.eventdata.ipAddress }}</span>
<span class="w">        </span><span class="nt">rule</span><span class="p">:</span>
<span class="w">            </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60204</span>
<span class="w">            </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">params</span><span class="p">:</span>
<span class="w">    </span><span class="nt">agents_list</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;003&quot;</span>
</pre></div>
</div>
<p>The above code contacts the <strong>Wazuh Server API</strong> with collected JWT Token to initiate its active response module to run
the <code class="docutils literal notranslate"><span class="pre">netsh</span></code> script on <code class="docutils literal notranslate"><span class="pre">windows</span></code> agents. The script has additional arguments such as <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">add,</span> <span class="pre">-</span> <span class="pre">delete,</span> <span class="pre">-</span> <span class="pre">[time]</span></code> for
blocking the malicious IP for a specific time and more based on the <code class="docutils literal notranslate"><span class="pre">rule.id</span> <span class="pre">60204</span></code> and its level of severity.
You can also set the list of windows agents you want the script to run on dynamically or statically based on the <code class="docutils literal notranslate"><span class="pre">agent.id</span></code> found on your wazuh server.</p>
<a class=""
               data-lightbox="group-d4a8fadb-c78c-4d53-b010-c1c3ec1ba7d9"
               href="../../_images/tracecat-server-workflow-contifiguration-51.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-51.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh Active Response Configuration for Windows Agents"/>
                </a><div style="height:25px;"></div></section>
<section id="core-http-request-active-response-for-macos">
<h2>core.http_request (Active Response for macOS)<a class="headerlink" href="#core-http-request-active-response-for-macos" title="Link to this heading"></a></h2>
<p>Go to the YAML tab. Copy and paste the below code block:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://[Wazuh_Sever_IP]:55000/active-response</span>
<span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PUT</span>
<span class="nt">verify_ssl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">headers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Authorization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Bearer ${{ ACTIONS.wazuh_api.result }}</span>
<span class="w">    </span><span class="nt">Content-Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">application/json</span>
<span class="nt">payload</span><span class="p">:</span>
<span class="w">    </span><span class="nt">arguments</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">add</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;!pf&quot;</span>
<span class="w">    </span><span class="nt">alert</span><span class="p">:</span>
<span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="w">            </span><span class="nt">srcip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ ACTIONS.wazuh_indexer_logs.result.data.hits.hits[0]._source.data.srcip }}</span>
<span class="w">        </span><span class="nt">rule</span><span class="p">:</span>
<span class="w">            </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5712</span>
<span class="w">            </span><span class="nt">level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">params</span><span class="p">:</span>
<span class="nt">agents_list</span><span class="p">:</span><span class="w"> </span><span class="c1"># must be an array argument</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;007&quot;</span>
</pre></div>
</div>
<p>The above code contacts the <strong>Wazuh Server API</strong> with collected JWT Token to initiate its active response module to run
the <code class="docutils literal notranslate"><span class="pre">pf</span></code> script on <code class="docutils literal notranslate"><span class="pre">macOS</span></code> agents. The script has additional arguments such as <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">add,</span> <span class="pre">-</span> <span class="pre">delete,</span> <span class="pre">-</span> <span class="pre">[time]</span></code> for
blocking the malicious IP for a specific time and more based on the <code class="docutils literal notranslate"><span class="pre">rule.id</span> <span class="pre">5712</span></code> and
its level of severity. You can also set the list of macOS agents you want the script to
run on dynamically or statically based on the <code class="docutils literal notranslate"><span class="pre">agent.id</span></code> found on your wazuh server.</p>
<a class=""
               data-lightbox="group-77f587d2-3436-4dd6-8f76-62683f006004"
               href="../../_images/tracecat-server-workflow-contifiguration-61.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-61.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server, Wazuh Active Response Configuration for macOS Agents"/>
                </a><div style="height:25px;"></div><div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Replace the <code class="docutils literal notranslate"><span class="pre">[Wazuh_Sever_IP]</span></code> with your actual Wazuh Sever IP. The default port for the Wazuh Server API is 55000 and the default port for the Wazuh Indexer API is 9200.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Inside the above code blocks you will notice some variables/expressions under <code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">[JSON_PATH]</span> <span class="pre">}}</span></code>.
hese are basically <strong>JSON_PATHS</strong> found under the <strong>Results</strong> section of your workflow.
Just copy the data or parameter value you need and paste it user <code class="docutils literal notranslate"><span class="pre">${{</span> <span class="pre">[JSON_PATH]</span> <span class="pre">}}</span></code> replacing <code class="docutils literal notranslate"><span class="pre">[JSON_PATH]</span></code>.
This is helpful if you want the parameters of your <code class="docutils literal notranslate"><span class="pre">YAML</span></code> configuration to be defined dynamically.
An image has been attached for your reference.</p>
<a class=""
               data-lightbox="group-9969f131-50f3-4404-b239-e8dd65932b39"
               href="../../_images/tracecat-server-workflow-contifiguration-71.png"
               title=""
               data-title=""
               
               ><img src="../../_images/tracecat-server-workflow-contifiguration-71.png"
                     class="align-center"
                     width="100%"
                     height="auto"
                     alt="Tracecat Server JSON Path Reference"/>
                </a></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The JSON paths in the above code blocks are just like variables named after the naming convention of the Title given to each component.
For example, <strong>ACTIONS.</strong> <code class="docutils literal notranslate"><span class="pre">wazuh_indexer_logs</span></code> <strong>.result.data.hits.hits[0]._source.rule.id</strong>, the quoted red colored area is
exactly as the Title set the to the Wazuh_Indexer_Logs core.http_response component.</p>
<p>Blindly copying and pasting the above code blocks might result in workflow execution <code class="docutils literal notranslate"><span class="pre">errors</span></code>.
Viewers are advised to work with the comfort oftheir local environmental setup.</p>
<p>The above code blocks are given only for representation purposes. The JSON path might be different from what has been showcased here.
That is why images have been given to follow it as a reference.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="prerequisite.html" class="btn btn-neutral float-left" title="Prerequisite" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="efficient-workflow-execution.html" class="btn btn-neutral float-right" title="Efficient Workflow Execution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Alsechemist.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>